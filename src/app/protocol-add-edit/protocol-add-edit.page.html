<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>
      {{ 'protocol.Protocol' | translate:params }}
    </ion-title>
    <ion-buttons slot="end">
      <ion-back-button text="{{ 'close' | translate:params }}"
                       type="button"
                       icon="null"
                       defaultHref="/feedback"
      >
      </ion-back-button>
    </ion-buttons>
    <sync-spinner-component slot="primary"></sync-spinner-component>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form>
    <ion-list>
      <ion-item>
        <protocol-default-component [protocol]="model"
                                    [protocol_form]="protocol_form"
                                    [isInsert]="!!!model[model.COL_ID]"
        >
        </protocol-default-component>
      </ion-item>
    </ion-list>
    <span *ngIf="!model[model.COL_ID] || (model.workflowStep && model.workflowStep.type !== 'final')">
      <ion-button slot="start" (click)="save()">
        <ion-icon slot="start" name="save"></ion-icon>
          {{ 'save' | translate:params }}
      </ion-button>
      <span *ngIf="model[model.COL_ID]">
        <ion-button *ngFor="let nextWorkflowTransition of model.workflowStep.workflowStepNextTransitions"
                color="medium"
                size="default"
                fill="outline"
                slot="end"
                (click)="transition(nextWorkflowTransition)"
        >
          <ion-icon slot="start" name="checkmark"></ion-icon>
          {{ nextWorkflowTransition.action_key }}
        </ion-button>
      </span>
    </span>


  </form>
</ion-content>
